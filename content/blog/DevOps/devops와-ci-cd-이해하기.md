---
title: DevOps와 CI CD 이해하기
date: 2021-06-30 16:06:78
category: DevOps
draft: false
---

## DevOps란?

DevOps란 개발(Development) + 운영(Operations)

- 개발 조직과 운영 조직 사이의 소통, 협업, 융합을 강화하는 개발 환경이나 문화를 말한다. 

 
## 왜 DevOps가 생기게 되었나?

소프트웨어는 개발부터 고객에게 배포될 때까지 개발, 테스트, 인프라 등 다양한 과정을 거치게 된다.

다양한 과정을 거치는 만큼 회사가 조금만 커져도 자연스럽게 각 단계를 진행하는데 반복적이고, 불필요한 작업과 오버헤드가 생기게 된다. 

결과적으로 배포 주기가 길어지고, 배포되는 변경 사항이 커지기 때문에 배포의 위험이 증가하게 된다. 또한, 고객에게 새로운 소프트웨어가 전달되기까지 오랜 시간이 걸리게 됩니다.

이러한 문제를 해결하기 위해 나온 개념이 DevOps이다.


## 장점

운영과 개발에 경계가 줄어듬으로 작업 속도가 빨라진다. 다시말해, 새로운 기능의 릴리스와 버그 수정 속도가 빨라지므로 고객의 요구에 더 빠르게 대응할 수 있다.

- 빠른 고객 혁신 가능


## 어떻게 DevOps를 실천할까? 

서버 구성, 배포, 테스트 등의 반복적이고 단순한 작업을 최대한 자동화해서 배포에 들어가는 비용을 최대한으로 줄이는 것부터 시작된다.

배포가 쉬워지면 작은 단위로도 배포를 여러 번 할 수 있게 되고, 결국 큰 장애가 발생하기 전에 문제를 바로 발견해서 해결할 수 있고 서비스를 민첩하게 운영할 수 있는 결과를 가져온다.

=> CI/CD


## CI/CD란?
- 애플리케이션 개발 단계를 자동화하여 짧은 주기로 고객에게 제공하는 방법을 말한다.
- 애플리케이션의 라이프사이클 전체에 걸쳐 지속적인 자동화와 지속적인 모니터링을 제공한다.
- 지속적인 통합(Continuous Integration), 지속적인 서비스 제공(Continuous Delivery), 지속적인 배포(Continuous Deployment)으로 구성

![ci/cd](./img/cicd.png)

### 1.  CI : 지속적 통합(Continuous Integration)
- 개발을 하면서 지속적으로 코드에 대한 통합을 진행함으로써 품질을 유지하자는 것을 말한다.
- 정기적인 빌드 및 테스트(유닛테스트 및 통합테스트)를 거쳐 공유 레포지토리에 병합
- 기존 코드와 신규 코드 간의 충돌 발생시, 버그를 빠르게 수정 가능

### 2. CD: 지속적인 서비스제공( Continuous Delivery)
- CI 프로세스를 통해 개발중에 지속적으로 빌드와 유닛 및 통합 테스트를 진행하고, 이를 통과한 코드에 대하여 테스트 서버와 운영 서버에 자동으로 릴리즈
- 운영팀이 보다 빠르고 손쉽게 배포 가능
- 프로덕션 환경으로 배포할 준비가 되어 있는 코드 베이스를 확보하는 것이 목표

### 3. CD : 지속적인 배포( Continuous Deployment)
- 프로덕션 준비가 완료된 빌드를 코드 리포지토리에 자동으로 릴리스
- 애플리케이션을 프로덕션으로 릴리스하는 작업을 자동화
- Continuous Delivery로 통칭하여 언급하기도 함
- 테스트와 빌드가 '지속적'으로 이루어지기 때문에, 배포 또한 '지속적'으로 이루어진다

## CI/CD 장단점
- 사용자 피드백을 지속적으로 수신하고 통합하는 일이 훨씬 수월해지게 한다. 
- 배포의 위험성을 줄여주므로 변경 사항을 작은 조각으로 세분화해서 손쉽게 릴리스할 수 있다. 
- 자동화된 테스트는 CI/CD 파이프라인의 여러 테스트 및 릴리스 단계를 수행할 수 있어야 하기 때문에 많은 선행 투자가 필요하다.


## 젠킨스(Jenkins)란?
젠킨스는 소프트웨어 개발 시 지속적인 통합 서비스를 제공하는 CI툴이다. 빌드, 테스트, 배포 등 모든 것을 자동화 해주는 서버이다.

## 젠킨스 역할
- Build 자동화
    - maven과 gradle을 젠킨스와 연동하여 빌드 자동화를 통해 프로젝트 진행의 효율성을 높일 수 있다.
- 자동화 테스트
    - Git과 같은 버전관리시스템과 연동하여 코드 변경을 감지하고 자동화 테스트를 수행하기 때문에 만약 개인이 미처 실시하지 못한 테스트가 있다 하여도 든든한 안전망이 되어준다.
- 코드 표준 준수여부 검사
    - 자동화 테스트와 마찬가지로 개인이 미처 실시하지 못한 코드 표준 준수 여부의 검사나 정적 분석을 통한 코드 품질 검사를 빌드 내부에서 수행함으로써 기술적 부채의 감소에도 크게 기여한다.
- 빌드 파이프라인 구성
    - 2개 이상의 모듈로 구성되는 레이어드 아키텍처가 적용 된 프로젝트에는 그에 따는 빌드 파이프라인 구성이 필요하다. 예를 들면, 도메인 -> 서비스 -> UI와 같이 각 레이어의 참조 관계에 따라 순차적으로 빌드를 진행하지 않으면 안된다. 젠킨스에서는 이러한 빌드 파이프라인의 구성을 간단히 할 수 있으며, 스크립트를 통해서 매우 복잡한 제어까지도 가능하다.

## 주요 플러그인
### 1. Credentials Plugin 
젠킨스는 단지 서버일 뿐이기 때문에 배포에 필요한 각종 리소스에 접근하기 위해서는 여러 중요한 정보를 저장하고 있어야한다.
이러한 중요한 정보(AWS token, Git Access token 등)를 저장해 주는 플러그인이다.

### 2. Pipeline Plugin 
파이프라인이란 CI/CD 파이프라인을 젠킨스에 구현하기 위한 일련의 플러그인들의 집합을 말한다.
즉, 여러 플러그인들을 이 파이프라인에서 용도에 맞게 사용하고, 정의함으로써 파이프라인을 통해서 서비스가 배포된다.

Declarative, Scripted Pipeline 두 형태의 Pipeline Syntax가 존재한다. 더 최신이고 가독성이 좋은 Declarative를 주로 사용한다.

**Pipeline Syntax**
- Agent Section
    - 어떤 젠킨스가 일을 하게 할 것인지를 지정한다
    - 젠킨스 노드 관리에서 새로 노드를 띄우거나 Docker 이미지를 통해 처리 가능
- Post Section
    - 스테이지가 끝난 이후의 결과에 따라 후속 조취를 취한다.
    - success, failure, always, cleanup
- Stages Section
    - 어떤 일들을 처리할 것인지 일련의 stage를 정의 (카테고리라고 생각)
- Steps Section
    - 한 stage 안에서의 단계로, 일련의 과정을 보여줌

- Declaratives
    - Enviroment : 어떤 Pipeline, stage scope 의 환경 변
    - Parameter : 파이프라인 실행 시 파마미터 받음
    - Trigger : 어떤 형태로 트리거 되는지 (어떤 주기로 실행 되는지)
    - When : 언제 실행되는지

### 3. Docker Plugin & Docker Pipeline 
젠킨스에서 도커를 사용하기 위함




### 참고
- https://ict-nroo.tistory.com/31